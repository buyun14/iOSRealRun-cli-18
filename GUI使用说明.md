# iOS Real Run GUI 使用说明

## 概述

本项目已成功添加了图形用户界面（GUI），让iOS跑步模拟器的使用更加简单直观。同时优化了路径文件的存储格式，支持更丰富的路径管理功能。

## 新增功能

### 1. GUI界面功能

- **可视化操作**: 通过图形界面进行所有操作，无需记忆命令行参数
- **实时状态显示**: 显示当前运行状态和详细日志信息
- **参数调节**: 通过滑块调整跑步速度和速度变化范围
- **路径管理**: 集成路径管理器，支持导入、导出、转换路径文件
- **一键操作**: 开始/停止跑步模拟，保存配置

### 2. 路径文件格式优化

#### 传统TXT格式（兼容）
```
{"lng":"108.76749520056279","lat":"34.03866879243831"},{"lng":"108.76790392956984","lat":"34.03879219143184"}
```

#### 新增JSON格式
```json
{
  "name": "路径名称",
  "coordinates": [
    {"lat": 34.03866879243831, "lng": 108.76749520056279},
    {"lat": 34.03879219143184, "lng": 108.76790392956984}
  ],
  "metadata": {
    "description": "路径描述",
    "distance": 1000.5,
    "created": "2025-01-09 12:00:00",
    "format": "json"
  }
}
```

## 启动方式

### GUI模式（推荐）
```bash
# Windows（管理员权限）
python start.py --gui
# 或直接运行
python start.py

# macOS（root权限）
sudo python3 start.py --gui
```

### 命令行模式
```bash
# Windows（管理员权限）
python start.py --cli
# 或直接运行
python main.py

# macOS（root权限）
sudo python3 start.py --cli
```

## GUI界面使用指南

### 主界面功能

1. **路径文件选择**
   - 点击"浏览"按钮选择路径文件
   - 支持TXT和JSON格式
   - 点击"管理"按钮打开路径管理器

2. **速度设置**
   - 跑步速度：1.0-10.0 m/s（默认4.2 m/s）
   - 速度变化范围：0-50%（默认15%）

3. **控制按钮**
   - **开始跑步**: 启动跑步模拟
   - **停止跑步**: 安全停止模拟
   - **保存配置**: 保存当前设置到config.yaml
   - **路径管理**: 打开路径管理器

4. **状态显示**
   - 实时显示当前状态（就绪/正在启动/正在跑步/已停止）
   - 状态颜色：绿色（运行中）、橙色（处理中）、红色（停止/错误）

5. **日志区域**
   - 显示详细的运行日志
   - 自动滚动到最新消息

### 路径管理器功能

1. **路径列表**
   - 显示所有可用路径文件
   - 显示格式、描述、距离、坐标数量等信息

2. **右键菜单**
   - **删除**: 删除选中的路径文件
   - **导出**: 导出为其他格式
   - **查看详情**: 显示路径详细信息

3. **功能按钮**
   - **刷新列表**: 重新扫描路径文件
   - **导入路径**: 导入新的路径文件
   - **转换格式**: 在TXT和JSON格式间转换

4. **双击选择**
   - 双击路径文件可直接选择使用

## 文件结构

```
项目根目录/
├── main.py              # 原始命令行主程序
├── gui.py               # GUI界面主程序
├── start.py             # 启动器（支持GUI/CLI模式）
├── route_manager.py     # 路径管理器
├── config.py            # 配置管理
├── config.yaml          # 配置文件
├── routes/              # 路径文件目录
│   └── YQ_route.json    # 示例JSON路径文件
├── YQroute.txt          # 原始TXT路径文件
└── requirements.txt     # 依赖列表
```

## 安装和使用步骤

1. **安装依赖**
   ```bash
   pip install -r requirements.txt
   ```

2. **准备设备**
   - 连接iPhone/iPad到电脑
   - 解锁设备并信任电脑
   - 执行：`pymobiledevice3 mounter auto-mount`

3. **启动程序**
   ```bash
   # Windows（管理员权限）
   python start.py
   
   # macOS（root权限）
   sudo python3 start.py
   ```

4. **使用GUI**
   - 选择路径文件
   - 调整参数
   - 点击"开始跑步"
   - 使用"停止跑步"安全退出

## 注意事项

1. **权限要求**: Windows需要管理员权限，macOS需要root权限
2. **设备连接**: 确保只有一台iOS设备连接
3. **安全退出**: 务必使用"停止跑步"按钮退出，避免直接关闭窗口
4. **路径文件**: 支持TXT和JSON两种格式，JSON格式包含更多元数据
5. **配置保存**: 修改参数后记得点击"保存配置"

## 故障排除

1. **GUI无法启动**: 检查是否安装了tkinter（Python内置）
2. **路径文件无法加载**: 检查文件格式是否正确
3. **设备连接失败**: 确保设备已解锁并信任电脑
4. **权限错误**: 确保以管理员/root权限运行

## 技术特性

- **异步处理**: 使用asyncio处理跑步模拟，不阻塞GUI
- **线程安全**: GUI和跑步逻辑分离，避免界面卡顿
- **格式兼容**: 完全兼容原有TXT格式，支持新的JSON格式
- **错误处理**: 完善的错误处理和用户提示
- **配置管理**: 自动保存和加载用户配置

通过这些改进，iOS Real Run现在提供了更加用户友好的界面和更强大的路径管理功能。
